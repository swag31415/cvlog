<!doctype html>
<html>

<body>
</body>

<head>
  <title>CVLog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="vendors/jquery/jquery-3.5.1.min.js"></script>
  <link rel="stylesheet" href="vendors/icono/icono.min.css">
  <style>
    div {
      padding-left: 2em;
    }
  </style>
  <script> // Helper funcs
    function div(...body) {
      var result = $("<div></div>")
      if (body) result.append(...body)
      return result
    }
    function plus_button() {
      return $("<button></button>")
        .addClass("icono-plusCircle")
    }
    function cross_button() {
      return $("<button></button>")
        .addClass("icono-crossCircle")
    }
  </script>
  <script>
    function get_input(required = false) {
      var result = $("<input></input>")
        .attr("type", "text")
      if (required) result.addClass("req")
      return result
    }
    // Converts json into an interactive string
    function to_istr(json) {
      var result = div()
      if (Array.isArray(json)) {
        result.append("[", plus_button().click(function () {
          var insert = to_istr(json[0])
          insert.append(cross_button().click(function () { $(this).parent().remove() }))
          $(this).after(insert)
          insert.not(":last-child").append(",")
        }), "]")
      } else switch (typeof json) {
        case "object":
          result.append("{")
          Object.keys(json).forEach(id => {
            result.append(div(to_istr(id), ": ", to_istr(json[id])))
          })
          result.contents().filter("div:not(:last-child)").append(",")
          result.append("}")
          break;
        case "function": return json()
        default: return json
      }
      return result
    }

    const input = () => get_input(true)
    const optional_input = () => get_input()

    $("body").append(to_istr(
      {
        "name": input,
        "phone_number": input,
        "email": input,
        "linkedin": optional_input,
        "github": optional_input,
        "gpa": optional_input,
        "test_scores": [
          {
            "test_name": input,
            "test_score": input
          }
        ]
      }
    ))
  </script>
</head>

</html>